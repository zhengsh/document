### volatile 关键字
* volatile 称之为轻量级锁，被volatile 修饰的变量，在线程之间是可见的。
  * 可见： 一个线程修改了这个变量的值，在另外一个线程中能够读到这个修改后的值。
  * synchronized 除了线程之间互斥以外，还有一个非常大的作用，就是保证可见性。

* 为了提高处理速度，处理器不直接和内存进行通信，而是先将系统内存的数据读到内部缓存(L1，L2或其他)后再进行操作，但操作完不知道何时会写到内存。如果对声明了volatile的 变量进行写操作，JVM就会向处理器发送一条Lock前缀的指令，将这个变量所在缓存行的数据 写回到系统内存。但是，就算写回到内存，如果其他处理器缓存的值还是旧的，再执行计算操 作就会有问题。所以，在多处理器下，为了保证各个处理器的缓存是一致的，就会实现缓存一 致性协议，每个处理器通过嗅探在总线上传播的数据来检查自己缓存的值是不是过期了，当 处理器发现自己缓存行对应的内存地址被修改，就会将当前处理器的缓存行设置成无效状 态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据读到处理器缓存里。

* Lock 指令
  * Lock前缀指令会引起处理器缓存回写到内存。
  * 一个处理器的缓存回写到内存会导致其他处理器的缓存无效。